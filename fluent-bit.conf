[SERVICE]
    Daemon       off
    Log_Level    info
    Parsers_File parsers.conf
    HTTP_Server  On
    HTTP_Listen  0.0.0.0
    HTTP_Port    2020

# -----------------------------
# Docker logs
# -----------------------------
[INPUT]
    Name              tail
    Path              /var/lib/docker/containers/*/*.log
    Parser            docker
    Tag               docker.containers
    Refresh_Interval  2
    Mem_Buf_Limit     50MB
    Skip_Long_Lines   On
    Docker_Mode       On
    Parser_Firstline  docker_multiline

# -----------------------------
# System logs
# -----------------------------
[INPUT]
    Name              tail
    Path              /var/log/syslog
    Parser            syslog
    Tag               system.syslog
    Refresh_Interval  2

[INPUT]
    Name              tail
    Path              /var/log/auth.log
    Parser            syslog
    Tag               system.auth
    Refresh_Interval  2

[INPUT]
    Name              tail
    Path              /var/log/kern.log
    Parser            syslog
    Tag               system.kernel
    Refresh_Interval  2

[INPUT]
    Name              tail
    Path              /var/log/*.log
    Parser            syslog
    Tag               system.apps
    Refresh_Interval  2

# -----------------------------
# Filter section
# -----------------------------
[FILTER]
    Name   modify
    Match  *
    Rename log message

# Optional: Drop very large or noisy lines
[FILTER]
    Name    grep
    Match   *
    Exclude message ^\s*$

# -----------------------------
# Output: stdout (for verification)
# -----------------------------
[OUTPUT]
    Name   stdout
    Match  *
    Format json_lines

# -----------------------------
# Output: Loki
# -----------------------------
[OUTPUT]
    Name              loki
    Match             *
    Host              44.204.1.97
    Port              3100
    URI               /loki/api/v1/push
    Labels            job=fluentbit,source=${HOSTNAME}
    Line_Format       json
    Log_Level         info
