# =============== Docker JSON Logs ===============
[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On
    Decode_Field_As json log

# =============== Docker Multiline Logs ===============
[PARSER]
    Name        docker_multiline
    Format      regex
    # Match timestamp + stream + logtag + message
    Regex       ^(?<time>[0-9-]+T[0-9:.]+Z)\s(?<stream>stdout|stderr)\s(?<logtag>[FP])\s(?<message>.*)$
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Time_Keep   On

# =============== Syslog / Auth / Kernel Logs ===============
[PARSER]
    Name        syslog
    Format      regex
    Regex       ^\<(?<pri>[0-9]+)\>(?<time>[^ ]+ [^ ]+ [^ ]+) (?<host>[^ ]+) (?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S
