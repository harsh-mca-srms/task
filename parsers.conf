
#              PARSERS CONFIG
##############################################

# ─── Docker Log Parser ──────────────────────────────────────
[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On
    # Extract container_name & log line from Docker JSON logs
    Decode_Field_As escaped log
    # Sometimes Docker adds newlines — handle gracefully
    # (Fluent Bit will auto-trim)

# ─── Syslog Parser ───────────────────────────────────────────
[PARSER]
    Name        syslog
    Format      regex
    Regex       ^\<(?<pri>[0-9]+)\>(?<time>[^ ]+ [^ ]+ [^ ]+) (?<host>[^ ]+) (?<process>[^:]+): (?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S
    Time_Keep   On

# ─── Auth Log Parser ─────────────────────────────────────────
[PARSER]
    Name        authlog
    Format      regex
    Regex       ^(?<time>[^ ]+ [^ ]+ [^ ]+) (?<host>[^ ]+) (?<process>[^:]+): (?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S
    Time_Keep   On

##############################################
#           END OF PARSERS
##############################################
